<!DOCTYPE html>
<html>

<head>
	<link rel="stylesheet" type="text/css" href="CSS.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script>
	$(document).ready(function() { /*畫面上所有的DOM都載入後*/
        var chK1,chK2,chK3,chK4,chK5=0;
        var full=0;
        var REID;
        ///////////////////////////////////////////SAVE鍵work
	$('#Sav').click(function() { 
        	
        	if(document.getElementById('Prc').value=='' || document.getElementById('Num').value=='' || document.getElementById('Projectname').value==1 )
                	alert("有必填未填");
        	else{
                	
                	if( full >= 5)
                        	alert("超過五個物品囉");
                	else{	
                    		
                    		full++;
                            if(REID=="Re1"){/////////判斷是否為正在更改的資料
            	$('#M1').text('0');REID="";full--;}else if(REID=="Re2"){
            	$('#M2').text('0');REID="";full--;}else if(REID=="Re3"){
            	$('#M3').text('0');REID="";full--;}else if(REID=="Re4"){
            	$('#M4').text('0');REID="";full--;}else if(REID=="Re5"){
            	$('#M5').text('0');REID="";full--;}
                
                            var This1= $('#M1').text();
                            var This2= $('#M2').text();
                            var This3= $('#M3').text();
                            var This4= $('#M4').text();
                            var This5= $('#M5').text();
                            
                            if(This1==0)
                            {
                            	                        
                                var T=$("#Projectname option:selected").text();
                        		$('#Pj1').text(T);
                            	var E=$("#Exp").text();
                                $("#E1").text(E);
                                
                                
                                
                            	var S = document.getElementById("Unit").value;
    							$('#U1').text(S);
                            
                            	var N = $('#Num').val();
								var P = $('#Prc').val();
							    $('#N1').text(N);
                       	 		$('#P1').text(P);
                         		var M=N*P;
                                
                            	$('#M1').text(M);
                            	$('#R1').show();    
                                
                                
                            
                            }else if(This2==0)
                            {
                            	var T=$("#Projectname option:selected").text();
                        		$('#Pj2').text(T);
                            
                            	var S = document.getElementById("Unit").value;
    							$('#U2').text(S);
                            
                            	var N = $('#Num').val();
								var P = $('#Prc').val();
							    
                            
                        		$('#N2').text(N);
                            	$('#P2').text(P);
                         		var M=N*P;
                            	$('#M2').text(M);
                            	$('#R2').show();
                            	
                            }else if(This3==0)
                            {
                            	var T=$("#Projectname option:selected").text();
                        		$('#Pj3').text(T);
                            
                            	var S = document.getElementById("Unit").value;
    							$('#U3').text(S);
                            
                            	var N = $('#Num').val();
								var P = $('#Prc').val();
							    
                            
                        		$('#N3').text(N);
                            
                        		var P=$('#Prc').val();
                       	 		$('#P3').text(P);
                         		var M=N*P;
                            	$('#M3').text(M);
                            	$('#R3').show();
                            	
                            }else if(This4==0)
                            {
                            	var T=$("#Projectname option:selected").text();
                        		$('#Pj4').text(T);
                            
                            	var S = document.getElementById("Unit").value;
    							$('#U4').text(S);
                            
                            	var N = $('#Num').val();
								var P = $('#Prc').val();
							    
                            
                        		$('#N4').text(N);
                            
                       	 		$('#P4').text(P);
                         		var M=N*P;
                            	$('#M4').text(M);
                            	$('#R4').show();
                            	
                            }else if(This5==0)
                            {
                            	var T=$("#Projectname option:selected").text();
                        		$('#Pj5').text(T);
                            
                            	var S = document.getElementById("Unit").value;
    							$('#U5').text(S);
                            
                            	var N = $('#Num').val();
								var P = $('#Prc').val();
							    
                            
                        		$('#N5').text(N);
                               	$('#P5').text(P);
                         		var M=N*P;
                           	 	$('#M5').text(M);	
                            	$('#R5').show();
                                
                            }
                            
                        	Count();
                            $(".input").find(":text,textarea,select").each(function() {
                				$(this).val("");
            					});
                            
                       	 	
                		 	return false; 
                	}
        	}
		});///////////////////////save end
        
        /////////////////////計算總金額的function:count
        function Count(){
        					var total=parseInt($('#M1').text()) + parseInt($('#M2').text()) + parseInt($('#M3').text()) + parseInt($('#M4').text()) + parseInt($('#M5').text());
                            $('#total').text(total);
        
        };
        
        ///////////////////Discard按鍵的function
        $("#Dsc").click(function(){
        	$(".input").find(":text,textarea,select").each(function() {
                $(this).val("");
            });
            if(REID=="Re1"){/////////判斷若為正在更改的資料按鍵放棄則直接秀出原始資料
            	$('#R1').show();REID="";}else if(REID=="Re2"){
            	$('#R2').show();REID="";}else if(REID=="Re3"){
            	$('#R3').show();REID="";}else if(REID=="Re4"){
            	$('#R4').show();REID="";}else if(REID=="Re5"){
            	$('#R5').show();REID="";}
        });
        
         $("#B1").click(function(){
            $('#R1').hide();$('#M1').text('0');Count();full--;
        });
		$("#B2").click(function(){
            $('#R2').hide();$('#M2').text('0');Count();full--;
        });
        $("#B3").click(function(){
            $('#R3').hide();$('#M3').text('0');Count();full--;
        });
        $("#B4").click(function(){
            $('#R4').hide();$('#M4').text('0');Count();full--;
        });
	 	$("#B5").click(function(){
            $('#R5').hide();$('#M5').text('0');Count();full--;
        });
        
        
        //////////////////////////Revise click
        $(".RR").click(function(event){
        	 REID= $(this).attr('id');  
             
             if(REID == "Re1" )
             {
             	var T=$("#Pj1").text();
             	var E=$("#E1").text();
             	var U=$("#U1").text();
             	var N = $('#N1').text();
             	var P =$('#P1').text();
             	var M = $('#M1').text();
                $('#R1').hide();
             }else if(REID == "Re2" )
             {
             	var T=$("#Pj2").text();
             	var E=$("#E2").text();
             	var U=$("#U2").text();
             	var N = $('#N2').text();
             	var P =$('#P2').text();
             	var M = $('#M2').text();
                $('#R2').hide();
             }else  if(REID == "Re3" )
             {
             	var T=$("#Pj3").text();
             	var E=$("#E3").text();
             	var U=$("#U3").text();
             	var N = $('#N3').text();
             	var P =$('#P3').text();
             	var M = $('#M3').text();
                $('#R3').hide();
             }else if(REID == "Re4" )
             {
             	var T=$("#Pj4").text();
             	var E=$("#E4").text();
             	var U=$("#U4").text();
             	var N = $('#N4').text();
             	var P =$('#P4').text();
             	var M = $('#M4').text();
                $('#R4').hide();
             }else if(REID == "Re5" )
             {
             	var T=$("#Pj5").text();
             	var E=$("#E5").text();
             	var U=$("#U5").text();
             	var N = $('#N5').text();
             	var P =$('#P5').text();
             	var M = $('#M5').text();
             	$('#R5').hide();
             }
             
             if(T=='消耗性器材')
             { $("#Projectname").val(2);
             }else if(T=='電腦使用費')
             { $("#Projectname").val(3);
             }else if(T=='雜支')
             { $("#Projectname").val(4);
             }else if(T=='資料檢索費')
             { $("#Projectname").val(5);
             }else if(T=='實驗動物')
             { $("#Projectname").val(6);
             }else if(T=='論文發表費')
             { $("#Projectname").val(7);
             }else if(T=='其他')
             { $("#Projectname").val(8);
             }
             
             $("#Exp").text(E);
             var uu = document.getElementById("Unit");
             var nn = document.getElementById("Num");
             var pp = document.getElementById("Prc");
             var mm = document.getElementById("Hwmc");
             
             uu.value =U;
             nn.value =N;
             pp.value =P;
             mm.value =M;
        });/////////////////////Revise end
    });
</script>
	  
</head>
<body>
<h2>各項費用</h2>
<div class="B">  
<h2 style="display:inline;">計畫名稱 :</h2> <h2 id="pro" style="display:inline;">電機多媒體計畫</h2>
</div>
<h3 style="display:inline;">總金額 :</h3><div id="total" style="display:inline;">0</div>
<table class="css_table" >
  <tr class="css_row">
    <td class="css_cell1"> 修改 </td>
    <td class="css_cell1"> 刪除 </td>
    <td class="css_cell2"> 項目名稱 </td>
    <td class="css_cell3"> 說明 </td>
    <td class="css_cell"> 單位 </td>
    <td class="css_cell"> 數量 </td>
    <td class="css_cell"> 單價 </td>
    <td class="css_cell"> 金額 </td>
  </tr>
  <tr class="css_row" id="R1" style="display:none;">
    <td class="css_cell1"><button class="RR" id="Re1">Revise</button></td>
    <td class="css_cell1"><button id="B1" >Delete</button></td>
    <td class="css_cell2" id="Pj1"></td>
    <td class="css_cell3" id="E1"></td>
    <td class="css_cell" id="U1"> 0 </td>
    <td class="css_cell" id="N1"> 0 </td>
    <td class="css_cell" id="P1"> 0 </td>
    <td class="css_cell" id="M1"> 0 </td>
  </tr>
  <tr class="css_row" id="R2" style="display:none;">
    <td class="css_cell1"><button class="RR" id="Re2">Revise</button></td>
    <td class="css_cell1"><button id="B2">Delete</button></td>
    <td class="css_cell2" id="Pj2"></td>
    <td class="css_cell3" id="E2"></td>
    <td class="css_cell" id="U2"> 0 </td>
    <td class="css_cell" id="N2"> 0 </td>
    <td class="css_cell" id="P2"> 0 </td>
    <td class="css_cell" id="M2"> 0 </td>
  </tr>
  <tr class="css_row" id="R3" style="display:none;">
    <td class="css_cell1"><button class="RR" id="Re3">Revise</button></td>
    <td class="css_cell1"><button id="B3">Delete</button></td>
    <td class="css_cell2" id="Pj3"></td>
    <td class="css_cell3" id="E3"></td>
    <td class="css_cell" id="U3"> 0 </td>
    <td class="css_cell" id="N3"> 0 </td>
    <td class="css_cell" id="P3"> 0 </td>
    <td class="css_cell" id="M3"> 0 </td>
  </tr>
  <tr class="css_row" id="R4" style="display:none;">
    <td class="css_cell1"><button class="RR" id="Re4">Revise</button></td>
    <td class="css_cell1"><button id="B4">Delete</button></td>
    <td class="css_cell2" id="Pj4"></td>
    <td class="css_cell3" id="E4"></td>
    <td class="css_cell" id="U4"> 0 </td>
    <td class="css_cell" id="N4"> 0 </td>
    <td class="css_cell" id="P4"> 0 </td>
    <td class="css_cell" id="M4"> 0 </td>
  </tr> 
  <tr class="css_row" id="R5" style="display:none;">
    <td class="css_cell1"><button class="RR" id="Re5">Revise</button></td>
    <td class="css_cell1"><button id="B5">Delete</button></td>
    <td class="css_cell2" id="Pj5"></td>
    <td class="css_cell3" id="E5"></td>
    <td class="css_cell" id="U5">0</td>
    <td class="css_cell" id="N5">0</td>
    <td class="css_cell" id="P5">0</td>
    <td class="css_cell" id="M5">0</td>
  </tr>
</table>
<div style="font-size: 16px; color:blue; display:inline;" ><br><br><br>說明:</div>
<div style="font-size: 16px; display:inline;"> 黃色為必填事項，灰色不需填寫</div>
  
	
<table style="background:#5BC8DD; border:solid 1px;" class="input">
  <tr>
    <td>項目名稱</td>
    <td  colspan="2" >
      <select id="Projectname"  style="background:yellow">
        <option selected="true" value="1">請選擇項目名稱</option>
        <option value="2" >消耗性器材</option>
        <option value="3" >電腦使用費</option>
        <option value="4" >雜支</option>
        <option value="5" >資料檢索費</option>
        <option value="6" >實驗動物</option>
        <option value="7" >論文發表費</option>
        <option value="8" >其他</option>
      </select>
    </td>
  </tr>
  
  <tr>
    <td>單位</td>
    <td>
      <input type="text" id="Unit" style="width:100px">
    </td>
    <td>數量</td>
    <td>
      <input type="text" id="Num" style="background:yellow;width:100px" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
    </td>
    <td>單價</td>
    <td>
      <input type="text" id="Prc" style="background:yellow;width:100px" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
    </td>
    <td>金額</td>
    <td>
      <input type="text" id="Hwmc" style="background:gray;width:100px" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" >
  </tr>
  
  <tr>
    <td>說明</td>
    <td  colspan="7" >
      <textarea cols="100" rows="5" id="Exp"></textarea>
    </td>
  </tr>  
  <tr>
    <td>備註</td>
    <td  colspan="7" >
      <textarea cols="100" rows="5" id="Rmk"></textarea>
  </tr>
    <tr>
    <td colspan="8">
    <button id="Sav">
    Save
    </button>
    <button id="Dsc">
    Discard
    </button>
    </td>
   </tr>
  
  
</table>
  
</body>
</html>
